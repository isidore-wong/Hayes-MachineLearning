## 数据标准化处理

### 1、概念
- 特征工程是对原始数据进行一系列工程处理，将其提炼为特征，作为输入供算法和模型使用。没有充足的数据、合适的特征，再强大的模型结构也无法得到满意的输出。
- 本质上，特征工程师一个表示和展现数据的过程；实际工作中，特征工程旨在去除原始数据中的杂质与冗余，设计个更加高效的特征以刻画求解的问题与预测模型之间的关系。

### 2、数据归一化
#### 2.1、概念
数据归一化/标准化处理是数据处理的基础工作，因为不同评价指标往往具有不同的量纲和量纲单位，会影响到分析结果，为消除这一影响，需要对数据进行标准化处理，以解决数据指标之间的可比性。原始数据经过数据标准化处理后，各指标处于同一数量级，适合进行综合对比评价。
~~~~
场景：分析一个人的身高和体重对健康的影响，如果用m和kg作为单位，身高在1.6-1.8m'之间，体重在50-100kg之间，分析的结果会倾向于数据差别比较大的体重特征，这种情况下为了得到更准确的结果，就需要进行特征归一化处理，使各指标处于同一数值量级。
~~~~

#### 2.2、数据标准化方法
1. 线性函数标准化(Min-Max Scaling)：对原始数据进行线性变换，使结果映射到[0, 1]范围内，实线对原始数据的等比缩放。公式如下：
```math
X_{norm} = \tfrac{X - X_{min}}{X_{max} - X_{min}} 
```
其中`$X$`为原始数据，`$X_{max}$`、`$X_{min}$`分别为数据最大值和最小值。
2. 零均值标准化(Z-Score Normalization)：将原始数据映射到均值为0，标准差为1的分布上。具体来说，假设原始特征的均值为`$\mu$`、标准差为`$\sigma$`，公式如下：
```math
z = \tfrac{x - \mu}{\sigma}
```
#### 3、用于稀疏数据的MaxAbs
最大值绝对值标准化(MaxAbs)，即根据最大值的绝对值进行表转化。假设原转换的数据为x，新数据为x'，那么
```math
x' = \tfrac {x} {|max|}
```
其中max为x所在列的最大值。
MaxAbs方法和Min-Max用法类似，也是将数据落入一定区间，但该方法的数据区间为[-1, 1]，MaxAbs方也具有不破坏原有数据分布结构的特点，因此可以用于稀疏数据，稀疏的CSR(行压缩)或CSC(列压缩)矩阵。

#### 4、问题
Q：为什么性需要对数值的特征做归一化处理？

A：数值归一化的原因如下：
1. 数据的量纲不同；数量级差别很大。经过标准化处理后，原始数据转化为无量纲化指标测评值，各指标值处于同一数量级别，可进行综合测评分析。如果直接用原始指标值进行分析，就会突出数值较高的指标在综合分析中的作用，相对削弱数值水平较低指标的作用。
2. 避免数值问题：太大的数会引发数值问题。
3. 平衡各特征的贡献，一些分类器需要计算样本之间的距离（如欧氏距离），例如KNN。
如果一个特征值域范围非常大，那么距离计算就主要取决于这个特征，从而与实际情况相悖（比如这时实际情况是值域范围小的特征更重要）。
4. 一些模型求解的需要：加快了梯度下降求最优解的速度

eg.梯度下降实例说明标准化的重要性。
- 假设有两个数值型特征，x1取值范围是[0, 10]，x2取值范围是[0, 3]，于是可以构造一个目标函数，在学习速率相同的情况下，x1的更新速度将会大于x2，需要较多的迭代才能找到最优解。如果将x1和x2归一化到相同的数值区间后，x1和x2的更新速度变得更为一致，容易更快的通过梯度下降找到最优解。

#### 5、归一化的应用场景
处理以下问题需要归一化：(距离、协方差，是因为要使各特征贡献一致所以使用标准化。梯度计算，是因为如果不标准化，模型的收敛会很慢或者不会收敛到最优解。)
- 分类（如k-nearest neighbors算法）
- 聚类（如k-means算法）使用距离（如欧几里得距离）来判定样本之间的相似度的分类和聚类问题，都要进行数据规范化。
- 支持向量机SVM，逻辑回归, perceptron, neural networks etc.上面这些问题使用梯度优化来获得最优解。比如支持向量机使用梯度优化得到将样本数据分开的最优超平面。
- 主成分分析，总之涉及到距离、协方差（比如PCA本质涉及协方差计算）、梯度计算的问题要进行标准化。

#### 6、不需要归一化处理的
如决策树模型并不适用，以C4.5为例，决策树在进行节点分裂时主要依据数据集D关于特征x的信息增益比，而信息增益比与特征是否经过归一化是无关的，因为归一化并不会改变样本在特征x上的信息增益。

[Show me the code](https://github.com/isidore-wong/MachineLearning-Algorithm/tree/master/00_DataProcessing%26FeatureEngineering)